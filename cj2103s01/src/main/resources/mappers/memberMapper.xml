<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.cj2103s01.dao.MemberDAO">

	<insert id="setMemberInput">
		insert into member values (#{vo.mId}, #{vo.mPwd}, #{vo.mName}, #{vo.mPost}, #{vo.mAddress}, #{vo.mPhone}, #{vo.mEmail}, #{vo.mGender}, default, #{vo.mBirth}, #{vo.mSolar}, default, default, default, #{vo.mCmid}, default);
	</insert>

	<select id="getIdCheck" resultType="com.spring.cj2103s01.vo.MemberVO">
		select * from member where mId = #{mId};
	</select>

	<update id="setMemberUpdate">
		update member set mPwd=#{vo.mPwd}, mName=#{vo.mName}, mPost=#{vo.mPost}, mAddress=#{vo.mAddress}, mPhone=#{vo.mPhone}, mEmail=#{vo.mEmail}, mGender=#{vo.mGender}, mBirth=#{vo.mBirth}, mSolar=#{vo.mSolar} where mId=#{vo.mId};
	</update>

	<update id="mDelete">
		update member set mDrop='YES' where mId=#{mId};
	</update>

	<select id="getPwdSearch" resultType="com.spring.cj2103s01.vo.MemberVO">
		select * from member where mId = #{mId} and mEmail = #{mEmail};
	</select>

	<update id="setPwdChange">
		update member set mPwd = #{encode} where mId=#{mId};
	</update>

	<select id="getNameSearch" resultType="com.spring.cj2103s01.vo.MemberVO">
		select * from member where mName = #{mName} and mEmail = #{mEmail};
	</select>

	<select id="getMemberList" resultType="com.spring.cj2103s01.vo.MemberVO">
		select * from member where mLevel > 0;
	</select>

	<select id="totMemberCnt" resultType="int">
		select count(*) from member where mLevel > 0;
	</select>

	<select id="dropMemberCnt" resultType="int">
		select count(*) from member where mDrop = 'YES';
	</select>
	
	<select id="totSearchRecCnt" resultType="int">
		select count(*) from member where ${search} like concat('%', #{searchString} ,'%') and NOT mLevel IN ('0');
	</select>
</mapper>